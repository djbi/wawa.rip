<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Snake Game with IP Obstacle</title>
    <style>
        body {
            background-color: black;
            margin: 0;
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            user-select: none;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            overflow: hidden;
        }
        #container {
            text-align: center;
            position: relative;
            width: 100%;
            height: 100%;
        }
        #game-canvas {
            display: none;
            background-color: black;
        }
        #visit-counter {
            color: white;
            font-size: 1em;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 5px;
            position: absolute;
            bottom: 10px;
            left: 50%;
            transform: translateX(-50%);
        }
        #eye-icon {
            width: 16px;
            height: 16px;
        }
        #count {
            color: #FF69B4;
            text-shadow: 0 0 5px #FF69B4;
            animation: counterGlow 2s infinite alternate;
        }
        #start-message {
            color: white;
            font-size: 1.5em;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
        }
        @keyframes counterGlow {
            from {
                color: #FF69B4;
                text-shadow: 0 0 5px #FF69B4, 0 0 10px #FF69B4;
            }
            to {
                color: #9400D3;
                text-shadow: 0 0 5px #9400D3, 0 0 10px #9400D3;
            }
        }
        @keyframes flash {
            0% { background-color: black; }
            50% { background-color: white; }
            100% { background-color: black; }
        }
        #creepy-image {
            display: none;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            max-width: 80%;
            max-height: 80%;
        }
    </style>
</head>
<body>
    <div id="container">
        <canvas id="game-canvas" width="800" height="600"></canvas>
        <div id="start-message">Double-click to start</div>
        <div id="visit-counter">
            <svg id="eye-icon" viewBox="0 0 24 24" fill="white">
                <path d="M12 4.5C7 4.5 2.73 7.61 1 12c1.73 4.39 6 7.5 11 7.5s9.27-3.11 11-7.5c-1.73-4.39-6-7.5-11-7.5zM12 17c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5zm0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3z"/>
            </svg>
            <span id="count">567</span>
        </div>
        <img id="creepy-image" src="https://th.bing.com/th/id/R.782d96615b2c2a6ed8520457e7fdb641?rik=2RIXD3DU8hJ0WA&pid=ImgRaw&r=0" alt="Creepy Image">
        <audio id="scream-audio" src="scream.mp3"></audio>
    </div>

    <script>
        const canvas = document.getElementById('game-canvas');
        const ctx = canvas.getContext('2d');
        const container = document.getElementById('container');
        const startMessage = document.getElementById('start-message');
        const creepyImage = document.getElementById('creepy-image');
        const screamAudio = document.getElementById('scream-audio');

        // Snake game variables
        const gridSize = 20;
        let snake = [{ x: 400, y: 300 }];
        let apple = { x: 0, y: 0 };
        let ipObstacle = { x: 0, y: 0, dx: 2, dy: 2, text: '' };
        let mouseX = 400, mouseY = 300;
        let speed = 5;
        let gameStarted = false;
        let clickCount = 0;

        // Neon colors for snake and IP
        const colors = [
            '#FF00FF', '#00FFFF', '#FF00AA', '#00FF00',
            '#FFFF00', '#FF6600', '#FF0099', '#00CCFF',
            '#FF3366', '#33FF33', '#FFCC00', '#FF0066'
        ];

        function getRandomColor() {
            return colors[Math.floor(Math.random() * colors.length)];
        }

        function spawnApple() {
            apple.x = Math.floor(Math.random() * (canvas.width / gridSize)) * gridSize;
            apple.y = Math.floor(Math.random() * (canvas.height / gridSize)) * gridSize;
        }

        function spawnIPObstacle(ip) {
            ipObstacle.text = ip;
            ipObstacle.x = Math.floor(Math.random() * (canvas.width - 100));
            ipObstacle.y = Math.floor(Math.random() * (canvas.height - 20));
            ipObstacle.dx = (Math.random() > 0.5 ? 2 : -2);
            ipObstacle.dy = (Math.random() > 0.5 ? 2 : -2);
        }

        function updateVisitCount() {
            let count = localStorage.getItem('visitCount');
            if (!count) count = 567;
            else count = parseInt(count) + 1;
            localStorage.setItem('visitCount', count);
            document.getElementById('count').textContent = count;
        }

        function gameLoop() {
            if (!gameStarted) return;

            // Clear canvas
            ctx.fillStyle = 'black';
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            // Move snake towards mouse
            let head = { x: snake[0].x, y: snake[0].y };
            const dx = mouseX - head.x;
            const dy = mouseY - head.y;
            const angle = Math.atan2(dy, dx);
            head.x += Math.cos(angle) * speed;
            head.y += Math.sin(angle) * speed;

            // Check collision with apple
            if (Math.abs(head.x - apple.x) < gridSize && Math.abs(head.y - apple.y) < gridSize) {
                snake.push({ x: snake[snake.length - 1].x, y: snake[snake.length - 1].y });
                spawnApple();
            }

            // Update snake body
            snake.unshift(head);
            snake.pop();

            // Move IP obstacle
            ipObstacle.x += ipObstacle.dx;
            ipObstacle.y += ipObstacle.dy;

            // Bounce IP obstacle off walls
            if (ipObstacle.x < 0 || ipObstacle.x > canvas.width - ctx.measureText(ipObstacle.text).width) {
                ipObstacle.dx = -ipObstacle.dx;
            }
            if (ipObstacle.y < 0 || ipObstacle.y > canvas.height - 20) {
                ipObstacle.dy = -ipObstacle.dy;
            }

            // Check collision with walls or IP obstacle
            const ipWidth = ctx.measureText(ipObstacle.text).width;
            const ipHeight = 20;
            if (head.x < 0 || head.x >= canvas.width || head.y < 0 || head.y >= canvas.height ||
                (head.x + gridSize > ipObstacle.x && head.x < ipObstacle.x + ipWidth &&
                 head.y + gridSize > ipObstacle.y && head.y < ipObstacle.y + ipHeight)) {
                gameOver();
                return;
            }

            // Draw snake
            snake.forEach((segment, index) => {
                ctx.fillStyle = getRandomColor();
                ctx.fillRect(segment.x, segment.y, gridSize - 2, gridSize - 2);
            });

            // Draw apple
            ctx.fillStyle = '#FF0000';
            ctx.fillRect(apple.x, apple.y, gridSize - 2, gridSize - 2);

            // Draw IP obstacle
            ctx.font = '20px Arial';
            ctx.fillStyle = getRandomColor();
            ctx.fillText(ipObstacle.text, ipObstacle.x, ipObstacle.y);

            requestAnimationFrame(gameLoop);
        }

        function gameOver() {
            gameStarted = false;
            canvas.style.display = 'none';
            
            // Flash screen and play scream
            document.body.style.animation = 'flash 0.2s 10';
            screamAudio.play();
            
            setTimeout(() => {
                document.body.style.animation = '';
                creepyImage.style.display = 'block';
            }, 2000);
        }

        // Start game on double click and fetch IP
        container.addEventListener('click', () => {
            clickCount++;
            if (clickCount === 2 && !gameStarted) {
                fetch('https://api.ipify.org?format=json')
                    .then(response => response.json())
                    .then(data => {
                        startMessage.style.display = 'none';
                        canvas.style.display = 'block';
                        gameStarted = true;
                        spawnApple();
                        spawnIPObstacle(data.ip);
                        updateVisitCount();
                        gameLoop();
                    })
                    .catch(error => {
                        console.error('Error fetching IP:', error);
                        startMessage.textContent = 'Error loading IP, starting anyway...';
                        setTimeout(() => {
                            startMessage.style.display = 'none';
                            canvas.style.display = 'block';
                            gameStarted = true;
                            spawnApple();
                            spawnIPObstacle('0.0.0.0'); // Fallback IP
                            updateVisitCount();
                            gameLoop();
                        }, 1000);
                    });
            }
        });

        // Track mouse movement
        document.addEventListener('mousemove', (e) => {
            const rect = canvas.getBoundingClientRect();
            mouseX = e.clientX - rect.left;
            mouseY = e.clientY - rect.top;
        });
    </script>
</body>
</html>
